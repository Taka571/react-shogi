(this["webpackJsonpreact-shogi"]=this["webpackJsonpreact-shogi"]||[]).push([[0],{10:function(e,t,n){e.exports=n(17)},17:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),a=n(9),c=n.n(a),s=(n(7),n(1)),o=function e(){Object(s.a)(this,e)};o.LENGTH=9,o.UNCLICKED=95,o.WHITE=7,o.MT=16,o.PIECES=["\u98db","\u89d2","\u91d1","\u9280","\u6842","\u9999","\u6b69","\u7389","\u7adc","\u99ac","","\u5168","\u572d","\u674f","\u3068",""],o.NUM=["","","\u30cb","\u4e09","\u56db","\u4e94","\u516d","\u4e03","\u516b","\u4e5d","\u5341","\u5341\u4e00","\u5341\u4e8c","\u5341\u4e09","\u5341\u56db","\u5341\u4e94","\u5341\u516d","\u5341\u4e03","\u5341\u516b"];var u=n(5),l=n(3),p=n(2),h=n(4),E=function(){function e(t,n,r){Object(s.a)(this,e),this._out=void 0,this._turn=void 0,this._piece_num=void 0,this._out=t,this._turn=n,this._piece_num=r}return Object(u.a)(e,[{key:"out",value:function(){return this._out}},{key:"turn",value:function(){return this._turn}},{key:"piece_num",value:function(){return this._piece_num}},{key:"promote",value:function(){this._piece_num+=o.MT/2,this._out=o.PIECES[this._piece_num]}}]),e}(),_=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6;return Object(s.a)(this,t),Object(l.a)(this,Object(p.a)(t).call(this,o.PIECES[n],e,n))}return Object(h.a)(t,e),t}(E),f=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;return Object(s.a)(this,t),Object(l.a)(this,Object(p.a)(t).call(this,o.PIECES[n],e,n))}return Object(h.a)(t,e),t}(E),v=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;return Object(s.a)(this,t),Object(l.a)(this,Object(p.a)(t).call(this,o.PIECES[n],e,n))}return Object(h.a)(t,e),t}(E),T=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;return Object(s.a)(this,t),Object(l.a)(this,Object(p.a)(t).call(this,o.PIECES[n],e,n))}return Object(h.a)(t,e),t}(E),N=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return Object(s.a)(this,t),Object(l.a)(this,Object(p.a)(t).call(this,o.PIECES[n],e,n))}return Object(h.a)(t,e),t}(E),H=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Object(s.a)(this,t),Object(l.a)(this,Object(p.a)(t).call(this,o.PIECES[n],e,n))}return Object(h.a)(t,e),t}(E),m=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Object(s.a)(this,t),Object(l.a)(this,Object(p.a)(t).call(this,o.PIECES[n],e,n))}return Object(h.a)(t,e),t}(E),b=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:7;return Object(s.a)(this,t),Object(l.a)(this,Object(p.a)(t).call(this,o.PIECES[n],e,n))}return Object(h.a)(t,e),t}(E),L=function(e){function t(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16;return Object(s.a)(this,t),Object(l.a)(this,Object(p.a)(t).call(this," ",e,n))}return Object(h.a)(t,e),t}(E);function k(e){var t="";return e.is_captured?t="captured":(t="square piece",e.is_black||(t+=" white")),e.is_final&&(t+=" final"),e.is_clicked&&(t+=" click"),e.can_control&&(t+=" attack"),i.a.createElement("button",{className:t,onClick:e.onClick},e.value)}var d=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"renderSquare",value:function(e,t,n,r){var a=this,c=r-2*o.WHITE,s=Math.floor(c/o.LENGTH),u=c%o.LENGTH;return i.a.createElement(k,{key:r,is_final:e,is_clicked:t,value:this.props.squares[s][u].out(),is_black:this.props.squares[s][u].turn(),is_captured:!1,can_control:n,onClick:function(){return a.props.onClick(r)}})}},{key:"content",value:function(e){for(var t=[],n=o.LENGTH-1;n>=0;--n)this.props.control_piece[n][e]?t.push(this.renderSquare(!1,!1,!0,n*o.LENGTH+e+2*o.WHITE)):n*o.LENGTH+e===this.props.final_piece-2*o.WHITE?t.push(this.renderSquare(!0,!1,!1,n*o.LENGTH+e+2*o.WHITE)):n*o.LENGTH+e===this.props.clicked_piece-2*o.WHITE?t.push(this.renderSquare(!1,!0,!1,n*o.LENGTH+e+2*o.WHITE)):t.push(this.renderSquare(!1,!1,!1,n*o.LENGTH+e+2*o.WHITE));return t}},{key:"render",value:function(){for(var e=new Array,t=0;t<o.LENGTH;++t)e=e.concat(i.a.createElement("div",{className:"board-row ley",key:t},this.content(t)));return i.a.createElement("div",null,e)}}]),t}(i.a.Component),w=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"renderSquare",value:function(e,t){var n=this;return i.a.createElement(k,{key:t,is_final:!1,is_clicked:e,value:o.PIECES[t],is_black:this.props.is_black,is_captured:!0,can_control:!1,onClick:this.props.is_black?function(){return n.props.onClick(t)}:function(){return n.props.onClick(t+o.WHITE)}})}},{key:"render",value:function(){for(var e=new Array,t=this.props.turn?this.props.clicked_piece:this.props.clicked_piece-o.WHITE,n=this.props.is_black,r=this.props.turn,a=0;a<o.WHITE;++a){var c=this.props.squares[a];c>0&&(e=a===t&&n===r?e.concat(i.a.createElement("div",{className:"board-row ley",key:a},this.renderSquare(!0,a))):e.concat(i.a.createElement("div",{className:"board-row ley",key:a},this.renderSquare(!1,a))),c>1&&(e=e.concat(i.a.createElement("div",{className:"board-row ley",key:"num"+a},i.a.createElement("button",{className:"number"},o.NUM[c])))))}return i.a.createElement("div",null,e)}}]),t}(i.a.Component),G=n(6),j=n.n(G);function O(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"lnsgkgsnl/1r5b1/ppppppppp/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL b - 1",t=(arguments.length>1&&void 0!==arguments[1]&&arguments[1],[]),n=0;n<o.LENGTH;++n){t[n]=[];for(var r=0;r<o.LENGTH;++r)t[n].push(new L)}if("lnsgkgsnl/1r5b1/ppppppppp/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL b - 1"===e){for(var i=0;i<o.LENGTH;++i)t[i][2]=new _(!1),t[i][6]=new _(!0);t[0][0]=new f(!1),t[8][0]=new f(!1),t[0][8]=new f(!0),t[8][8]=new f(!0),t[1][0]=new v(!1),t[7][0]=new v(!1),t[1][8]=new v(!0),t[7][8]=new v(!0),t[2][0]=new T(!1),t[6][0]=new T(!1),t[2][8]=new T(!0),t[6][8]=new T(!0),t[3][0]=new N(!1),t[5][0]=new N(!1),t[3][8]=new N(!0),t[5][8]=new N(!0),t[1][1]=new H(!1),t[7][7]=new H(!0),t[7][1]=new m(!1),t[1][7]=new m(!0),t[4][0]=new b(!1),t[4][8]=new b(!0)}return t}function y(e,t){var n=new L;return 0===e&&(n=new m(t)),1===e&&(n=new H(t)),2===e&&(n=new N(t)),3===e&&(n=new T(t)),4===e&&(n=new v(t)),5===e&&(n=new f(t)),6===e&&(n=new _(t)),n}function I(){return new Array(o.WHITE).fill(0)}function C(){for(var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=[],n=0;n<o.LENGTH;++n)t[n]=new Array(o.LENGTH).fill(e);return t}function g(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:-1,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:-1,s=!(arguments.length>7&&void 0!==arguments[7])||arguments[7],u=t[r][i].piece_num();if(6!==u)if(2===u||3===u||4===u||7===u||11<=u&&u<=14){var l,p;4===u?(l=new Array(-1,1),p=new Array(-2,-2)):3===u?(l=new Array(-1,0,1,1,-1),p=new Array(-1,-1,-1,1,1)):2===u||11<=u&&u<=14?(l=new Array(-1,0,1,1,0,-1),p=new Array(-1,-1,-1,0,1,0)):s?(l=new Array(-1,0,1,1,1,0,-1,-1),p=new Array(-1,-1,-1,0,1,1,1,0)):(l=new Array(0),p=new Array(0));for(var h=0;h<l.length;++h){var E=n?r+l[h]:r-l[h],_=n?i+p[h]:i-p[h];0<=E&&E<o.LENGTH&&0<=_&&_<o.LENGTH&&(++e[E][_],E===a&&_===c&&(e[o.LENGTH][0]=r*o.LENGTH+i,e[o.LENGTH][1]=u))}}else if(5!==u)if(1!==u&&9!==u)if(0!==u&&8!==u);else{for(var f=new Array(0,1,0,-1),v=new Array(-1,0,1,0),T=0;T<f.length;++T)for(var N=r+f[T],H=i+v[T];0<=N&&N<o.LENGTH&&0<=H&&H<o.LENGTH&&(++e[N][H],N===a&&H===c&&(e[o.LENGTH][0]=r*o.LENGTH+i,e[o.LENGTH][1]=u),t[N][H].piece_num()===o.MT||7===t[N][H].piece_num()&&t[N][H].turn()!==n);)N+=f[T],H+=v[T];if(8===u){f=new Array(-1,1,1,-1),v=new Array(-1,-1,1,1);for(var m=0;m<f.length;++m){var b=r+f[m],L=i+v[m];0<=b&&b<o.LENGTH&&0<=L&&L<o.LENGTH&&(++e[b][L],b===a&&L===c&&(e[o.LENGTH][0]=r*o.LENGTH+i,e[o.LENGTH][1]=u))}}}else{for(var k=new Array(-1,1,1,-1),d=new Array(-1,-1,1,1),w=0;w<k.length;++w)for(var G=r+k[w],j=i+d[w];0<=G&&G<o.LENGTH&&0<=j&&j<o.LENGTH&&(++e[G][j],G===a&&j===c&&(e[o.LENGTH][0]=r*o.LENGTH+i,e[o.LENGTH][1]=u),t[G][j].piece_num()===o.MT||7===t[G][j].piece_num()&&t[G][j].turn()!==n);)G+=k[w],j+=d[w];if(9===u){k=new Array(0,1,0,-1),d=new Array(-1,0,1,0);for(var O=0;O<k.length;++O){var y=r+k[O],I=i+d[O];0<=y&&y<o.LENGTH&&0<=I&&I<o.LENGTH&&(++e[y][I],y===a&&I===c&&(e[o.LENGTH][0]=r*o.LENGTH+i,e[o.LENGTH][1]=u))}}}else for(var C=-1,g=n?i+C:i-C;0<=g&&g<o.LENGTH&&(++e[r][g],r===a&&g===c&&(e[o.LENGTH][0]=r*o.LENGTH+i,e[o.LENGTH][1]=u),t[r][g].piece_num()===o.MT||7===t[r][g].piece_num()&&t[r][g].turn()!==n);)g=n?g+C:g-C;else if(n?0!==i:i!==o.LENGTH-1){var S=n?i-1:i+1;++e[r][S],r===a&&S===c&&(e[o.LENGTH][0]=r*o.LENGTH+i,e[o.LENGTH][1]=u)}}function S(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:-1,c=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],s=[],u=0;u<o.LENGTH+1;++u)s[u]=new Array(o.LENGTH).fill(0);if(-1!==n)return g(s,e,t,n,r),s;for(var l=0;l<o.LENGTH;++l)for(var p=0;p<o.LENGTH;++p)e[l][p].piece_num()!==o.MT&&e[l][p].turn()===t&&g(s,e,t,l,p,i,a,c);return s}function P(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1;if(-1===r)for(var a=0;a<o.LENGTH;++a)for(var c=0;c<o.LENGTH;++c)if(7===e[a][c].piece_num()&&e[a][c].turn()===n){r=a,i=c,a=o.LENGTH,c=o.LENGTH;break}var s=S(e,n,-1,-1,-1,-1,!1),u=S(e,!n,-1,-1,r,i),l=u[r][i];if(0===l)return 0;if(l>1)return 10*l;var p=u[o.LENGTH][0],h=Math.floor(p/o.LENGTH),E=p%o.LENGTH,_=u[o.LENGTH][1];if(0===_||1===_||5===_||8===_||9===_){var f=h-r,v=E-i;0!==f&&(f/=Math.abs(f)),0!==v&&(v/=Math.abs(v));for(var T=r+f,N=i+v;T!==h||N!==E;){if(s[T][N]>0)return 11;for(var H=0;H<o.WHITE;++H)if(0!==t[H]){var m=j.a.cloneDeep(e);if(m[T][N]=y(H,n),A(e,m,t,-1,-1,r,N,!n)){if(6===H&&M(m,T,n))continue;return 11}}T+=f,N+=v}}return 10}function W(e,t,n){for(var r=-1,i=-1,a=0;a<o.LENGTH;++a)for(var c=0;c<o.LENGTH;++c)if(7===e[a][c].piece_num()&&e[a][c].turn()===n){r=a,i=c,a=o.LENGTH,c=o.LENGTH;break}var s=P(e,t,n,r,i);if(0===s)return!1;for(var u=S(e,!n),l=new Array(1,1,0,-1,-1,-1,0,1),p=new Array(0,1,1,1,0,-1,-1,-1),h=0;h<l.length;++h){var E=r+l[h],_=i+p[h];if(!(E<0||o.LENGTH<=E||_<0||o.LENGTH<=_)&&((e[E][_].piece_num()===o.MT||e[E][_].turn()!==n)&&0===u[E][_]))return!1}return Math.floor(s/10)>1||s%10<1}function A(e,t,n,r,i,a,c,s){var u=t[a][c].piece_num();return-1===r?4===u?s?c>1:c<o.LENGTH-1-1:5===u?s?0!==c:c!==o.LENGTH-1:6!==u||(s?0!==c:c!==o.LENGTH-1)&&!W(t,n,!s):S(e,s,r,i)[a][c]>0}function M(e,t,n){for(var r=0,i=0;i<o.LENGTH;++i)6===e[t][i].piece_num()&&e[t][i].turn()===n&&++r;return r>=2}var q=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(p.a)(t).call(this,e))).state={start_pos:n.props.start_pos,start_black_piece:n.props.start_black_piece,start_white_piece:n.props.start_white_piece,current_pos:n.props.current_pos,current_black_piece:n.props.current_black_piece,current_white_piece:n.props.current_white_piece,control_piece:n.props.control_piece,kifu:n.props.kifu,turn:n.props.turn,moves:n.props.moves,moves_sub:n.props.moves_sub,clicked_piece:n.props.clicked_piece,final_piece:n.props.final_piece,black_name:n.props.black_name,white_name:n.props.white_name,is_black:n.props.is_black},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"handleClick",value:function(e){var t=this;if(!(this.state.moves<0)){var n=this.state.clicked_piece,r=this.state.turn,i=j.a.cloneDeep(this.state.current_pos),a=j.a.cloneDeep(this.state.current_black_piece),c=j.a.cloneDeep(this.state.current_white_piece);if(e<2*o.WHITE){if(n===o.UNCLICKED){if(r?e<o.WHITE&&a[e]>0:e>=o.WHITE&&c[e-o.WHITE]>0){for(var s=C(!0),u=e>=o.WHITE?e-o.WHITE:e,l=0;l<o.LENGTH;++l)for(var p=0;p<o.LENGTH;++p)i[l][p].piece_num()!==o.MT?s[l][p]=!1:4===u?s[l][p]=r?p>1:p<o.LENGTH-1-1:5===u?s[l][p]=r?0!==p:p!==o.LENGTH-1:6===u&&(s[l][p]=r?0!==p:p!==o.LENGTH-1,i[l][p]=y(u,r),M(i,l,r)&&(s[l][p]=!1),(r?p>1&&7===i[l][p-1].piece_num()&&i[l][p-1].turn()!==r:p<o.LENGTH-1&&7===i[l][p+1].piece_num()&&i[l][p+1].turn()!==r)&&W(i,r?c:a,!r)&&(s[l][p]=!1),i[l][p]=new L),s[l][p]&&(i[l][p]=y(u,r),s[l][p]=!P(i,r?c:a,r),i[l][p]=new L);this.setState({control_piece:s,clicked_piece:e})}return}this.setState({clicked_piece:o.UNCLICKED,control_piece:C()})}else{var h=Math.floor((e-2*o.WHITE)/o.LENGTH),E=(e-2*o.WHITE)%o.LENGTH,_=this.state.current_pos.concat();if(this.state.clicked_piece!==o.UNCLICKED){if(this.state.control_piece[h][E]){var f=this.state.moves,v=j.a.cloneDeep(a),T=j.a.cloneDeep(c),N=-1,H=-1;if(n<2*o.WHITE)r?(--v[n],i[h][E]=y(n,r)):(--T[n-o.WHITE],i[h][E]=y(n-o.WHITE,r));else{N=Math.floor((n-2*o.WHITE)/o.LENGTH),H=(n-2*o.WHITE)%o.LENGTH;var m=i[h][E];i[h][E]=i[N][H],i[N][H]=new L;var b=m.piece_num();b!==o.MT&&(b>o.WHITE&&(b-=o.MT/2),r?++v[b]:++T[b])}var k=i[h][E].piece_num();if(-1!==N&&(r?E<3||H<3:E>o.LENGTH-1-3||H>o.LENGTH-1-3)&&k<o.WHITE&&""!==o.PIECES[k+o.MT/2]){var d=!1;5<=k&&k<=6?(r?0===E:E===o.LENGTH-1)&&(i[h][E].promote(),d=!0):4===k&&(r?E<2:E>o.LENGTH-1-2)&&(i[h][E].promote(),d=!0),d||window.confirm("\u6210\u308a\u307e\u3059\u304b\uff1f")&&i[h][E].promote()}return this.setState({current_pos:i,current_black_piece:v,current_white_piece:T,control_piece:C(),turn:!r,moves:f+1,moves_sub:f+1,clicked_piece:o.UNCLICKED,final_piece:e}),W(i,r?T:v,!r)?(setTimeout((function(){alert("\u307e\u3067".concat(f+1,"\u624b\u306b\u3066").concat(r?t.state.black_name:t.state.white_name,"\u306e\u52dd\u3061\u3067\u3059\uff01"))}),200),void this.setState({moves:-1})):void 0}this.setState({control_piece:C(),clicked_piece:o.UNCLICKED})}else{if(_[h][E].piece_num()===o.MT||_[h][E].turn()!==r)return;for(var w=S(_,r,h,E,-1,-1,!1),G=C(!1),O=0;O<o.LENGTH;++O)for(var I=0;I<o.LENGTH;++I)if(0!==w[O][I]&&(_[O][I].piece_num()===o.MT||_[O][I].turn()!==r)){var g=i[O][I];i[O][I]=i[h][E],i[h][E]=new L,G[O][I]=0===P(i,r?a:c,r),i[h][E]=i[O][I],i[O][I]=g}this.setState({control_piece:G,clicked_piece:e})}}}}},{key:"resign",value:function(){var e=this,t=this.state.moves;if(!(t<0))return window.confirm("\u6295\u4e86\u3057\u307e\u3059\u304b\uff1f")?(setTimeout((function(){alert("\u307e\u3067".concat(t,"\u624b\u306b\u3066").concat(e.state.turn?e.state.white_name:e.state.black_name,"\u306e\u52dd\u3061\u3067\u3059\uff01"))}),200),void this.setState({moves:-1})):void 0}},{key:"rotate",value:function(){this.setState({is_black:!this.state.is_black})}},{key:"render",value:function(){var e=this,t="game-info";this.state.is_black||(t+=" white");var n=this.state.moves_sub;return i.a.createElement("div",{className:"game-info"},i.a.createElement("div",{className:"game"},i.a.createElement("div",{className:"center bold"},"\u25b3".concat(this.state.white_name,"\u3000").concat(n,"\u624b\u76ee\u3000\u25b2").concat(this.state.black_name)),i.a.createElement("div",{className:t},i.a.createElement("div",{className:"game-info-white white"},i.a.createElement("div",null,"\u25b3"),i.a.createElement(w,{squares:this.state.current_white_piece,clicked_piece:this.state.clicked_piece,is_black:!1,turn:this.state.turn,onClick:function(t){return e.handleClick(t)}})),i.a.createElement("div",{className:"game-board"},i.a.createElement(d,{squares:this.state.current_pos,onClick:function(t){return e.handleClick(t)},clicked_piece:this.state.clicked_piece,control_piece:this.state.control_piece,final_piece:this.state.final_piece})),i.a.createElement("div",{className:"game-info-black"},i.a.createElement("div",null,"\u25b2"),i.a.createElement(w,{squares:this.state.current_black_piece,clicked_piece:this.state.clicked_piece,is_black:!0,turn:this.state.turn,onClick:function(t){return e.handleClick(t)}})))),i.a.createElement("button",{className:"status",onClick:function(){return e.rotate()}},"\u53cd\u8ee2"),i.a.createElement("button",{className:"status",onClick:function(){return e.resign()}},"\u6295\u4e86"))}}]),t}(i.a.Component);c.a.render(i.a.createElement(q,{start_pos:O(),start_black_piece:I(),start_white_piece:I(),current_pos:O(),current_black_piece:I(),current_white_piece:I(),control_piece:C(),kifu:[],turn:!0,moves:0,moves_sub:0,clicked_piece:o.UNCLICKED,final_piece:o.UNCLICKED,black_name:"\u5148\u624b",white_name:"\u5f8c\u624b",is_black:!0}),document.getElementById("root"))},7:function(e,t,n){}},[[10,1,2]]]);
//# sourceMappingURL=main.f3d386ff.chunk.js.map